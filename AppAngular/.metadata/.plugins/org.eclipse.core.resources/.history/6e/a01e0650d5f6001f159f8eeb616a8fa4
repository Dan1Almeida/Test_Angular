package br.com.dnl.AppAngular.Service;

import java.util.List;
import java.util.Optional;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import br.com.dnl.AppAngular.Model.Contatos;
import br.com.dnl.AppAngular.Model.Pessoas;
import br.com.dnl.AppAngular.Repository.ContatosRepository;
import br.com.dnl.AppAngular.Repository.PessoasRepository;

@Service
public class ContatosService {

    @Autowired
    private ContatosRepository contatosRepository;
    
    @Autowired
    private PessoasRepository pessoasRepository;

    // ----- SALVAR -------------------------------------------------------------
    public Contatos cadastrarContato(Long pessoaId, Contatos contato) {
        Optional<Pessoas> pessoa = pessoasRepository.findById(pessoaId);

        if (pessoa.isPresent()) {
            contato.setPessoa(pessoa.get()); 
            return contatosRepository.save(contato);
        } else {
            throw new RuntimeException("Pessoa n√£o encontrada!");
        }
    }

    // ----- ENCONTRAR POR ID -------------------------------------------------------------
    public Optional<Contatos> findById(Long id) {
        return contatosRepository.findById(id);
    }

    // ----- LISTAGEM -------------------------------------------------------------
    public List<Contatos> findAll() {
        return contatosRepository.findAll();
    }

    // ----- ATUALIZAR -------------------------------------------------------------
    public Contatos update(Long id, Contatos contato) {
        Optional<Contatos> findContato = contatosRepository.findById(id);

        if (findContato.isPresent()) {
            Contatos updContato = findContato.get();

            updContato.setCelular(contato.getCelular());
            updContato.setTipo(contato.getTipo());
            updContato.setContato(contato.getContato());

            return contatosRepository.save(updContato);
        }

        return null; 
    }

    // ----- DELETAR -------------------------------------------------------------
    public void delete(Long id) {
        contatosRepository.deleteById(id);
    }
}
